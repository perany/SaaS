var tesEvent = require("./suanf.js");

function pathCOme(value) {
    var ap = []
    ap[1] = {
        id: '6$0'
    }
    ap[2] = {
        id: '6$0'
    }
    ap[3] = {
        id: '6$0'
    }
    ap[4] = {
        id: '6$0'
    }
    ap[5] = {
        id: '6$1'
    }
    ap[6] = {
        id: '6$2'
    }
    ap[7] = {
        id: '6$4'
    }
    ap[8] = {
        id: '6$4'
    }
    ap[9] = {
        id: '6$4'
    }
    ap[10] = {
        id: '6$5'
    }
    ap[11] = {
        id: '6$5'
    }
    ap[12] = {
        id: '6$5'
    }
    ap[13] = {
        id: '5$6'
    }
    ap[14] = {
        id: '5$8'
    }
    ap[15] = {
        id: '5$9'
    }
    ap[16] = {
        id: '5$9'
    }
    ap[17] = {
        id: '5$10'
    }
    ap[18] = {
        id: '5$10'
    }
    ap[19] = {
        id: '4$10'
    }
    ap[20] = {
        id: '2$10'
    }
    ap[21] = {
        id: '2$10'
    }
    ap[22] = {
        id: '2$9'
    }
    ap[23] = {
        id: '2$9'
    }
    ap[24] = {
        id: '2$8'
    }
    ap[25] = {
        id: '2$8'
    }
    ap[26] = {
        id: '2$8'
    }
    ap[27] = {
        id: '2$8'
    }
    ap[28] = {
        id: '3$8'
    }
    ap[29] = {
        id: '4$8'
    }
    ap[30] = {
        id: '4$8'
    }
    ap[31] = {
        id: '3$8'
    }
    ap[32] = {
        id: '3$6'
    }
    ap[33] = {
        id: '2$5'
    }
    ap[34] = {
        id: '2$4'
    }
    ap[35] = {
        id: '3$4'
    }
    ap[36] = {
        id: '3$4'
    }
    ap[37] = {
        id: '3$2'
    }
    ap[38] = {
        id: '3$1'
    }
    ap[39] = {
        id: '3$1'
    }
    ap[40] = {
        id: '3$0'
    }
    ap[41] = {
        id: '3$0'
    }
    ap[42] = {
        id: '4$2'
    }
    ap[43] = {
        id: '5$2'
    }
    ap[44] = {
        id: '5$5'
    }
    ap[45] = {
        id: '4$5'
    }
    ap[46] = {
        id: '4$5'
    }
    ap[47] = {
        id: '4$4'
    }
    ap[48] = {
        id: '3$4'
    }
    ap[49] = {
        id: '2$4'
    }
    ap[50] = {
        id: '8$0'
    }
    ap[51] = {
        id: '8$0'
    }
    ap[52] = {
        id: '7$1'
    }
    ap[53] = {
        id: '8$1'
    }
    ap[54] = {
        id: '8$4'
    }
    ap[55] = {
        id: '8$8'
    }
    ap[56] = {
        id: '8$10'
    }
    ap[57] = {
        id: '8$11'
    }
    ap[58] = {
        id: '7$10'
    }
    ap[59] = {
        id: '6$8'
    }
    ap[60] = {
        id: '4$11'
    }
    ap[61] = {
        id: '4$11'
    }
    ap[62] = {
        id: '4$11'
    }
    ap[63] = {
        id: '4$11'
    }
    ap[64] = {
        id: '4$11'
    }
    ap[65] = {
        id: '4$10'
    }
    ap[66] = {
        id: '4$10'
    }
    ap[67] = {
        id: '4$10'
    }
    ap[68] = {
        id: '3$10'
    }
    ap[69] = {
        id: '2$9'
    }
    ap[70] = {
        id: '1$9'
    }
    ap[71] = {
        id: '1$10'
    }
    ap[72] = {
        id: '1$10'
    }
    ap[73] = {
        id: '1$10'
    }
    ap[74] = {
        id: '1$10'
    }
    ap[75] = {
        id: '1$10'
    }
    ap[76] = {
        id: '1$11'
    }
    ap[77] = {
        id: '1$11'
    }
    ap[78] = {
        id: '1$11'
    }
    ap[79] = {
        id: '1$11'
    }
    ap[80] = {
        id: '1$11'
    }
    ap[81] = {
        id: '1$11'
    }
    ap[82] = {
        id: '1$11'
    }
    ap[83] = {
        id: '0$10'
    }
    ap[84] = {
        id: '0$10'
    }
    ap[85] = {
        id: '0$10'
    }
    ap[86] = {
        id: '0$9'
    }
    ap[87] = {
        id: '0$8'
    }
    ap[88] = {
        id: '1$8'
    }

    var xypoint = {
        '0$8': {
            x: 745,
            y: 143
        },
        '0$9': {
            x: 846,
            y: 143
        },
        '0$10': {
            x: 971,
            y: 143
        },
        '1$8': {
            x: 745,
            y: 181
        },
        '1$9': {
            x: 846,
            y: 181
        },
        '1$10': {
            x: 971,
            y: 181
        },
        '1$11': {
            x: 1160,
            y: 181
        },
        '2$4': {
            x: 493,
            y: 200
        },
        '2$5': {
            x: 538,
            y: 192
        },
        '2$8': {
            x: 745,
            y: 225
        },
        '2$9': {
            x: 838,
            y: 225
        },
        '2$10': {
            x: 971,
            y: 225
        },
        '3$0': {
            x: 120,
            y: 330
        },
        '3$1': {
            x: 256,
            y: 332
        },
        '3$2': {
            x: 362,
            y: 316
        },
        '3$3': {
            x: 493,
            y: 285
        },
        '3$4': {
            x: 493,
            y: 285
        },
        '3$6': {
            x: 668,
            y: 318
        },
        '3$8': {
            x: 745,
            y: 318
        },
        '3$10': {
            x: 971,
            y: 318
        },
        '4$2': {
            x: 367,
            y: 349
        },
        '4$4': {
            x: 510,
            y: 318
        },
        '4$5': {
            x: 567,
            y: 338
        },
        '4$6': {
            x: 668,
            y: 338
        },
        '4$8': {
            x: 745,
            y: 338
        },
        '4$10': {
            x: 971,
            y: 353
        },
        '4$11': {
            x: 1160,
            y: 353
        },
        '5$2': {
            x: 380,
            y: 380
        },
        '5$3': {
            x: 380,
            y: 380
        },
        '5$5': {
            x: 560,
            y: 390
        },
        '5$6': {
            x: 668,
            y: 390
        },
        '5$7': {
            x: 700,
            y: 390
        },
        '5$8': {
            x: 745,
            y: 390
        },
        '5$9': {
            x: 745,
            y: 390
        },
        '5$10': {
            x: 971,
            y: 390
        },
        '6$0': {
            x: 120,
            y: 420
        },
        '6$1': {
            x: 338,
            y: 420
        },
        '6$2': {
            x: 391,
            y: 420
        },
        '6$3': {
            x: 391,
            y: 420
        },
        '6$4': {
            x: 474,
            y: 420
        },
        '6$5': {
            x: 560,
            y: 420
        },
        '6$6': {
            x: 668,
            y: 396
        },
        '6$7': {
            x: 700,
            y: 396
        },
        '6$8': {
            x: 745,
            y: 396
        },
        '6$9': {
            x: 838,
            y: 396
        },
        '6$10': {
            x: 971,
            y: 396
        },
        '7$1': {
            x: 345,
            y: 463
        },
        '7$4': {
            x: 474,
            y: 463
        },
        '7$8': {
            x: 745,
            y: 463
        },
        '7$10': {
            x: 971,
            y: 463
        },
        '8$0': {
            x: 120,
            y: 520
        },
        '8$1': {
            x: 353,
            y: 520
        },
        '8$2': {
            x: 380,
            y: 520
        },
        '8$2': {
            x: 400,
            y: 520
        },
        '8$4': {
            x: 475,
            y: 520
        },
        '8$5': {
            x: 550,
            y: 520
        },
        '8$6': {
            x: 650,
            y: 520
        },
        '8$7': {
            x: 700,
            y: 520
        },
        '8$8': {
            x: 745,
            y: 520
        },
        '8$9': {
            x: 838,
            y: 520
        },
        '8$10': {
            x: 971,
            y: 520
        },
        '8$11': {
            x: 1160,
            y: 520
        }
    }

    //var path = '54,4,52,58,50,51,40,1,41,2,53,9,57,60,3,56'.split(',')
    //var path1 = '62,27,52,39,4,56,41,38,60,58,14,40,87,88,59,53'.split(',')
    //var path2 = '62,3,58,8,53,1,50,5,52,12,2,44,9,56,6,60'.split(',')

    if(!value){
        return { path: [], cr: ['', ''] }
    }
    var path2 = value.split(',')
    var www = [path2]
    var zuizhong = []
    for (var i = 0; i < www.length; i++) {
        zuizhong.push(returnPath(www[i]))
    }

    function returnImagePic(value, ino) {
        var pimpath = {}
        switch (value) {
            case '3$0':
                pimpath.pic = 'images/dmp/men/l' + ino + '.png'
                pimpath.x = 75 * 1.424
                pimpath.y = (330 - 12) * 1.424
                break
            case '6$0':
                pimpath.pic = 'images/dmp/men/l' + ino + '.png'
                pimpath.x = 75 * 1.424
                pimpath.y = (420 - 12) * 1.424
                break
            case '1$11':
                pimpath.pic = 'images/dmp/men/r' + ino + '.png'
                pimpath.x = 1170 * 1.424
                pimpath.y = 174 * 1.424
                break
            case '4$11':
                pimpath.pic = 'images/dmp/men/r' + ino + '.png'
                pimpath.x = 1170 * 1.424
                pimpath.y = (353 - 12) * 1.424
                break
            case '8$1':
                pimpath.pic = 'images/dmp/men/d' + ino + '.png'
                pimpath.x = (353 - 15) * 1.424
                pimpath.y = 525 * 1.424
                break
            case '8$4':
                pimpath.pic = 'images/dmp/men/d' + ino + '.png'
                pimpath.x = (475 - 15) * 1.424
                pimpath.y = 525 * 1.424
                break
            case '8$8':
                pimpath.pic = 'images/dmp/men/d' + ino + '.png'
                pimpath.x = (745 - 15) * 1.424
                pimpath.y = 525 * 1.424
                break
            case '8$10':
                pimpath.pic = 'images/dmp/men/d' + ino + '.png'
                pimpath.x = (971 - 15) * 1.424
                pimpath.y = 525 * 1.424
                break
        }
        return pimpath
    }

    function returnPath(path) {
        var newArr = []
        for (var i = 1; i < path.length; i++) {
            // console.log(path[i])
            if (ap[path[i - 1]].id != ap[path[i]].id) {
                var luj = new tesEvent()
                    // console.log(ap[path[i - 1]].id, ap[path[i]].id)
                luj.astar([ap[path[i - 1]].id], ap[path[i]].id, '', true)
                    //console.log(luj)
                newArr = newArr.concat(luj.endpath)
            }
        }
        newArr.push(ap[path[path.length - 1]].id)
        var morePath = ''
        for (var j = 0; j < newArr.length; j++) {
            // console.log(newArr[j])
            if (j == 0) {
                morePath += 'M' + xypoint[newArr[j]].x * 1.424 + ' ' + xypoint[newArr[j]].y * 1.424
            } else {
                morePath += 'L' + xypoint[newArr[j]].x * 1.424 + ' ' + xypoint[newArr[j]].y * 1.424
            }
        }
        // console.log(morePath)
        return morePath
    }
    return { path: zuizhong, cr: [returnImagePic(ap[path2[0]].id, 'i'), returnImagePic(ap[path2[path2.length - 1]].id, 'o')] }
}
module.exports = pathCOme;
